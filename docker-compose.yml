version: '3.8'

services:
  server:
    build: .
    container_name: cipherlink-server
    ports:
      - "8888:8888"
    volumes:
      - ./keys:/app/keys:ro
      - ./logs:/app/logs
    environment:
      - CIPHERLINK_SERVER_HOST=0.0.0.0
      - CIPHERLINK_SERVER_PORT=8888
      - CIPHERLINK_LOG_LEVEL=INFO
    command: ["python", "scripts/run_server.py", "--host", "0.0.0.0", "--port", "8888"]
    restart: unless-stopped

  client:
    build: .
    container_name: cipherlink-client
    volumes:
      - ./keys:/app/keys:ro
      - ./logs:/app/logs
    environment:
      - CIPHERLINK_SERVER_HOST=server
      - CIPHERLINK_SERVER_PORT=8888
      - CIPHERLINK_LOG_LEVEL=INFO
    command: ["python", "scripts/run_client.py", "--server-host", "server", "--server-port", "8888"]
    depends_on:
      - server
    restart: unless-stopped

